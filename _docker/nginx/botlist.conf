#-*- mode: nginx; mode: flyspell-prog; ispell-local-dictionary: "american" -*-
### This file implements a blacklist for certain user agents and
### referrers. It's a first line of defense. It must be included
### inside a http block.


## Add here all user agents that are to be blocked.
map $http_user_agent $bad_bot {
    default 0;
    ~*^Lynx 0; # Allow Lynx through
    # Block common bad bots (case-insensitive matching with ~*)
    ~*(meta-externalagent|PetalBot|Scrapy|ltx71|httrack|htmlparser|libwww|11A465|Ahrefs|ArchiveBot|AspiegelBot|Baiduspider|BLEXBot|Bytespider|Curebot|Daum|Detectify|DotBot|Grapeshot|heritrix|Kinza|LieBaoFast|Linguee|LMY47V|MauiBot|Mb2345Browser|MegaIndex|MicroMessenger|MJ12bot|MQQBrowser|PageFreezer|PetalBot|PiplBot|Riddler|Screaming\.Frog|Search365bot|SearchBlox|Seekport|SemanticScholarBot|SemrushBot|SEOkicks|serpstatbot|Siteimprove\.com|Sogou\.web\.spider|trendictionbot|TurnitinBot|UCBrowser|weborama-fetcher|Vagabondo|VelenPublicWebCrawler|YandexBot|YisouSpider) 1;
}


## Add here all user agents that are okay but that we will rate limit.
map $http_user_agent $good_bot {
    default "";
    ~*(Googlebot|Googlebot-Mobile|Google-Extended|bingbot|FacebookBot|GPTBot|ChatGPT-User|ClaudeBot|Claude-Web|PerplexityBot|CCBot) 1;
}

## Add here all referrers that are to blocked.
map $http_referer $bad_referer {
    default 0;
    ~*(adult|babes|click|diamond|forsale|girl|jewelry|love|nudit|organic|poker|porn|poweroversoftware|sex|teen|webcam|zippo|casino|replica) 1;
}

## Add here all hosts that should be spared any referrer checking.
geo $bad_referer {
    127.0.0.1 0;
    192.168.1.0/24 0;
}
